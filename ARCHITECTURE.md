# Customer Dashboard - Architecture & Flow

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PALMA E-COMMERCE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                    NEXT.JS FRONTEND                     â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚  PUBLIC PAGES        â”‚  PROTECTED PAGES               â”‚     â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚     â”‚
â”‚  â”‚  âœ“ Home             â”‚  ğŸ”’ /dashboard                 â”‚     â”‚
â”‚  â”‚  âœ“ Shop Products    â”‚  ğŸ”’ /dashboard/orders          â”‚     â”‚
â”‚  â”‚  âœ“ About            â”‚  ğŸ”’ /dashboard/profile         â”‚     â”‚
â”‚  â”‚  âœ“ Contact          â”‚  ğŸ”’ /checkout                  â”‚     â”‚
â”‚  â”‚  âœ“ Cart             â”‚                                â”‚     â”‚
â”‚  â”‚  âœ“ Login/Signup     â”‚  AUTH PAGES                    â”‚     â”‚
â”‚  â”‚                      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚     â”‚
â”‚  â”‚                      â”‚  âœ“ /auth/login                â”‚     â”‚
â”‚  â”‚                      â”‚  âœ“ /auth/signup               â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              CONTEXT & STATE MANAGEMENT                â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚     â”‚
â”‚  â”‚  â”‚  AuthProvider   â”‚  â”‚  ProductProviderâ”‚            â”‚     â”‚
â”‚  â”‚  â”‚  â—‡ useAuth()    â”‚  â”‚  (existing)     â”‚            â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚     â”‚
â”‚  â”‚  â”‚  CartProvider   â”‚  â”‚  Custom Hooks   â”‚            â”‚     â”‚
â”‚  â”‚  â”‚  (existing)     â”‚  â”‚  â—‡ useUserProfileâ”‚            â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â—‡ useUserOrdersâ”‚            â”‚     â”‚
â”‚  â”‚                        â”‚  â—‡ useOrderDetails           â”‚     â”‚
â”‚  â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚           CUSTOM COMPONENTS & PAGES                    â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚  Dashboard Components:                                 â”‚     â”‚
â”‚  â”‚  â”œâ”€ dashboard-order-history                           â”‚     â”‚
â”‚  â”‚  â”œâ”€ dashboard-profile-card                            â”‚     â”‚
â”‚  â”‚  â””â”€ dashboard-delivery-tracking                       â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚  Dashboard Pages:                                      â”‚     â”‚
â”‚  â”‚  â”œâ”€ dashboard/layout (sidebar nav)                    â”‚     â”‚
â”‚  â”‚  â”œâ”€ dashboard/page (overview)                         â”‚     â”‚
â”‚  â”‚  â”œâ”€ dashboard/orders/page                             â”‚     â”‚
â”‚  â”‚  â”œâ”€ dashboard/orders/[id]/page                        â”‚     â”‚
â”‚  â”‚  â”œâ”€ dashboard/profile/page                            â”‚     â”‚
â”‚  â”‚  â””â”€ auth/login & auth/signup                          â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚           TAILWIND CSS + SHADCN/UI                     â”‚     â”‚
â”‚  â”‚  (Styling & Pre-built Components)                      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚        SUPABASE CLIENT (lib/supabase.ts)              â”‚     â”‚
â”‚  â”‚  â—‡ Real-time data sync                               â”‚     â”‚
â”‚  â”‚  â—‡ Type-safe queries                                 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SUPABASE BACKEND                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚              AUTHENTICATION                          â”‚       â”‚
â”‚  â”‚  â€¢ Email/Password signup & login                     â”‚       â”‚
â”‚  â”‚  â€¢ JWT token management                              â”‚       â”‚
â”‚  â”‚  â€¢ Session persistence                               â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚            POSTGRESQL DATABASE                       â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚       â”‚
â”‚  â”‚  â”‚ profiles     â”‚  â”‚ orders       â”‚                â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚       â”‚
â”‚  â”‚  â”‚ id (PK)      â”‚  â”‚ id (PK)      â”‚                â”‚       â”‚
â”‚  â”‚  â”‚ email        â”‚  â”‚ user_id (FK) â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚       â”‚
â”‚  â”‚  â”‚ full_name    â”‚  â”‚ order_number â”‚               â”‚â”‚       â”‚
â”‚  â”‚  â”‚ phone        â”‚  â”‚ status       â”‚               â”‚â”‚       â”‚
â”‚  â”‚  â”‚ address      â”‚  â”‚ total_amount â”‚               â”‚â”‚       â”‚
â”‚  â”‚  â”‚ city         â”‚  â”‚ shipping_... â”‚               â”‚â”‚       â”‚
â”‚  â”‚  â”‚ state        â”‚  â”‚ ...          â”‚               â”‚â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚â”‚       â”‚
â”‚  â”‚                                                      â”‚â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚â”‚       â”‚
â”‚  â”‚  â”‚ order_items  â”‚  â”‚ products     â”‚                â”‚â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚â”‚       â”‚
â”‚  â”‚  â”‚ id (PK)      â”‚  â”‚ id (PK)      â”‚                â”‚â”‚       â”‚
â”‚  â”‚  â”‚ order_id(FK) â”‚â†’â”€â”‚ id           â”‚   â”œâ”€ Profiles â”€â”˜â”‚       â”‚
â”‚  â”‚  â”‚ product_id   â”‚â†’ â”‚ name         â”‚   |               â”‚       â”‚
â”‚  â”‚  â”‚ quantity     â”‚  â”‚ price        â”‚                â”‚       â”‚
â”‚  â”‚  â”‚ price        â”‚  â”‚ stock        â”‚                â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ ...          â”‚                â”‚       â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚          ROW LEVEL SECURITY (RLS)                    â”‚       â”‚
â”‚  â”‚  â€¢ Users can only access their own data              â”‚       â”‚
â”‚  â”‚  â€¢ Admin operations separate                          â”‚       â”‚
â”‚  â”‚  â€¢ All write operations protected                     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram

```
USER AUTHENTICATION FLOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Sign Up                              Login
  â†“                                   â†“
[Email, Password, Full Name] â† [Email, Password]
  â†“                                   â†“
Supabase Auth                    Supabase Auth
  â”œâ”€ Hash password                  â”œâ”€ Verify password
  â”œâ”€ Create user                    â”œâ”€ Create session
  â””â”€ Return user ID                 â””â”€ Return JWT token
  â†“                                   â†“
Create Profile Record            Set Session (Context)
  â†“                                   â†“
AuthProvider Updates              AuthProvider Updates
  â†“                                   â†“
Redirect to Dashboard â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ User Logged In
  â†“
Access Protected Routes


DASHBOARD DATA FLOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

useAuth() Hook
    â†“
Get Current User ID
    â†“
useUserProfile(userId)           useUserOrders(userId)
    â†“                                 â†“
Query profiles table         Query orders table
    â†“                                 â†“
Fetch user details           Fetch all user orders
    â†“                                 â†“
Update with updateProfile()  Filter & sort by date
    â†“                                 â†“
Save to profiles table       Return to component
    â†“
Display in ProfileCard


ORDER DETAILS FLOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Click "View Details"
    â†“
Get Order ID from URL param
    â†“
useOrderDetails(orderId)
    â†“
Query orders with relationships
    â†“
Fetch: â”œâ”€ Order header info
       â”œâ”€ Order items with product details
       â””â”€ Shipping information
    â†“
Map items to product info
    â†“
Display full order details + tracking
```

## Component Hierarchy

```
RootLayout
â”œâ”€â”€ AuthProvider
â”‚   â”œâ”€â”€ ProductProvider
â”‚   â”‚   â””â”€â”€ CartProvider
â”‚   â”‚       â”œâ”€â”€ Header
â”‚   â”‚       â”‚   â”œâ”€â”€ Logo
â”‚   â”‚       â”‚   â”œâ”€â”€ Navigation
â”‚   â”‚       â”‚   â”œâ”€â”€ Cart Badge
â”‚   â”‚       â”‚   â””â”€â”€ User Menu
â”‚   â”‚       â”‚       â”œâ”€â”€ Dashboard Link
â”‚   â”‚       â”‚       â””â”€â”€ Logout Button
â”‚   â”‚       â”‚
â”‚   â”‚       â””â”€â”€ Pages
â”‚   â”‚           â”œâ”€â”€ / (Home)
â”‚   â”‚           â”œâ”€â”€ /products
â”‚   â”‚           â”œâ”€â”€ /cart
â”‚   â”‚           â”œâ”€â”€ /admin
â”‚   â”‚           â”‚
â”‚   â”‚           â”œâ”€â”€ /auth/login
â”‚   â”‚           â”œâ”€â”€ /auth/signup
â”‚   â”‚           â”‚
â”‚   â”‚           â””â”€â”€ /dashboard (Protected)
â”‚   â”‚               â”œâ”€â”€ DashboardLayout
â”‚   â”‚               â”‚   â”œâ”€â”€ Sidebar
â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ Dashboard Link
â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ Orders Link
â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ Profile Link
â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ Back to Shop
â”‚   â”‚               â”‚   â”‚   â””â”€â”€ Logout
â”‚   â”‚               â”‚   â”‚
â”‚   â”‚               â”‚   â””â”€â”€ MainContent
â”‚   â”‚               â”‚
â”‚   â”‚               â”œâ”€â”€ /dashboard (Overview)
â”‚   â”‚               â”‚   â”œâ”€â”€ StatsCards
â”‚   â”‚               â”‚   â”œâ”€â”€ QuickLinks
â”‚   â”‚               â”‚   â””â”€â”€ RecentOrders
â”‚   â”‚               â”‚
â”‚   â”‚               â”œâ”€â”€ /dashboard/orders
â”‚   â”‚               â”‚   â””â”€â”€ OrderHistory
â”‚   â”‚               â”‚       â””â”€â”€ OrderCard (multiple)
â”‚   â”‚               â”‚
â”‚   â”‚               â”œâ”€â”€ /dashboard/orders/[id]
â”‚   â”‚               â”‚   â”œâ”€â”€ OrderHeader
â”‚   â”‚               â”‚   â”œâ”€â”€ DeliveryTracking
â”‚   â”‚               â”‚   â”œâ”€â”€ OrderItems
â”‚   â”‚               â”‚   â””â”€â”€ ShippingDetails
â”‚   â”‚               â”‚
â”‚   â”‚               â””â”€â”€ /dashboard/profile
â”‚   â”‚                   â”œâ”€â”€ ProfileCard
â”‚   â”‚                   â””â”€â”€ EditForm
â”‚   â”‚
â”‚   â””â”€â”€ Footer
```

## State Management Flow

```
User Authentication State
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
AuthProvider
â”œâ”€â”€ session (Session | null)
â”œâ”€â”€ user (User | null)
â”œâ”€â”€ isLoading (boolean)
â”œâ”€â”€ signIn(email, password)
â”œâ”€â”€ signUp(email, password, name)
â””â”€â”€ signOut()
    â†“
useAuth() Hook
    â†“
All protected components

Product & Cart State
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ProductProvider (existing)
â”œâ”€â”€ products: Product[]
â””â”€â”€ CRUD operations

CartProvider (existing)
â”œâ”€â”€ cart: CartItem[]
â”œâ”€â”€ totalItems
â”œâ”€â”€ totalPrice
â””â”€â”€ CRUD operations

Dashboard Data State
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
useUserProfile(userId)
â”œâ”€â”€ profile: Profile | null
â”œâ”€â”€ loading: boolean
â”œâ”€â”€ error: Error | null
â””â”€â”€ updateProfile()

useUserOrders(userId)
â”œâ”€â”€ orders: Order[]
â”œâ”€â”€ loading: boolean
â”œâ”€â”€ error: Error | null
â””â”€â”€ updateOrderStatus()

useOrderDetails(orderId)
â”œâ”€â”€ order: OrderWithItems | null
â”œâ”€â”€ loading: boolean
â””â”€â”€ error: Error | null
```

## API/Database Operations

```
Supabase Client Operations
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Authentication
  supabase.auth.signUp()
  supabase.auth.signInWithPassword()
  supabase.auth.signOut()
  supabase.auth.getSession()
  supabase.auth.onAuthStateChange()

User Profile
  supabase.from('profiles').select()
  supabase.from('profiles').update()

Orders
  supabase.from('orders').select()
  supabase.from('orders').update()

Order Items with Relationships
  supabase.from('orders').select(`
    *,
    order_items(
      *,
      products(id, name, price, image_url)
    )
  `)
```

## Security & Access Control

```
Route Protection
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Public Routes
â”œâ”€â”€ /
â”œâ”€â”€ /products
â”œâ”€â”€ /about
â”œâ”€â”€ /contact
â”œâ”€â”€ /auth/login
â””â”€â”€ /auth/signup

Protected Routes (Require Authentication)
â”œâ”€â”€ /dashboard â†’ useAuth() check â†’ Redirect to login if !user
â”œâ”€â”€ /dashboard/orders
â”œâ”€â”€ /dashboard/orders/[id]
â”œâ”€â”€ /dashboard/profile
â””â”€â”€ /checkout (when implemented)

Row Level Security (Supabase)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User can only access:
â”œâ”€â”€ profiles where id = current_user_id
â”œâ”€â”€ orders where user_id = current_user_id
â”œâ”€â”€ order_items of their orders
â””â”€â”€ All public product data
```

---

This architecture ensures:
âœ… Secure authentication
âœ… Data isolation per user
âœ… Type-safe operations
âœ… Scalable structure
âœ… Real-time capabilities
âœ… Easy maintenance
